

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Macrocell options (WIP) &mdash; Project Bureau  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="I/O buffer options" href="buffer.html" />
    <link rel="prev" title="Naming conventions" href="../naming.html" /> 
</head>

<body class="wy-body-for-nav">

  
    

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Project Bureau
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outline.html">Functional outline (WIP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../naming.html">Naming conventions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Macrocell options (WIP)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pt1-pt2-routing-group">PT1/PT2 routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pt3-routing-group">PT3 routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pt4-routing-group">PT4 routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pt5-routing-group">PT5 routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#d-q-routing-group">D/Q routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fb-routing-group">FB routing group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ff-latch-configuration">FF/latch configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="buffer.html">I/O buffer options</a></li>
<li class="toctree-l1"><a class="reference internal" href="power.html">Power control options</a></li>
<li class="toctree-l1"><a class="reference internal" href="program.html">Programming options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schema.html">Database schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explore.html">Database explorer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jtag/index.html">JTAG programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Command-line tools</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Project Bureau</a>
        
      </nav>


      <div class="wy-nav-content">
    
        
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Macrocell options (WIP)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/options/logic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="macrocell-options-wip">
<h1>Macrocell options (WIP)<a class="headerlink" href="#macrocell-options-wip" title="Permalink to this headline">¶</a></h1>
<p>The design of the ATF15xx macrocell is remarkably complicated; the combination of backwards compatibility, cost optimization, ad-hoc evolution, and pressure to add more routing options has resulted in a circuit that is almost biological in nature. The amount of macrocell edge cases that bring out bugs in the vendor toolchain seems to demonstrate that it is challenging to use even with first-party documentation. Nevertheless, with the right approach, even this macrocell can be painlessly understood.</p>
<p>The ATF15xx macrocell appears to have been designed by strictly following two rules:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Never route a product term to more than one destination.</p></li>
<li><p>Never let a fuse combination become redundant.</p></li>
</ol>
</div></blockquote>
<p>Rule (1) requires that, even though a product term may be routed through multiple muxes/decoders, these components (and by extension the fuses that drive them) must act together to prevent the product term from being connected to more than one possible destination at once. E.g. there must be no configuration where <code class="docutils literal notranslate"><span class="pre">PT4</span></code> drives <code class="docutils literal notranslate"><span class="pre">CLK</span></code> and <code class="docutils literal notranslate"><span class="pre">CE</span></code> simultaneously.</p>
<p>Rule (2) requires that, when any redundancies happen to arise from the layout of the macrocell routing paths, the fuse combinations that encode the redundant configurations must be repurposed for a new capability, without particular regard to orthogonality, and even at the cost of eliminating some rarely needed but otherwise reasonable configurations. E.g. the fuse that controls the fast registered input, <a class="reference internal" href="../schema.html#std-fuse-dfast_mux"><code class="xref std std-fuse docutils literal notranslate"><span class="pre">dfast_mux</span></code></a>, is physically shared with the fuse that controls the output multiplexer, <a class="reference internal" href="../schema.html#std-fuse-o_mux"><code class="xref std std-fuse docutils literal notranslate"><span class="pre">o_mux</span></code></a>.</p>
<div class="admonition-fun-fact admonition">
<p class="admonition-title">Fun fact</p>
<p>Both of these rules are violated in exactly one obscure corner case, specific to each rule.</p>
</div>
<p>In reality, these “rules” could well have been a natural consequence of conserving NVM cells and/or routability and not something that was followed explicitly. Regardless, the macrocell design is a lot easier to understand from this perspective.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="pt1-pt2-routing-group">
<span id="cas-mux"></span><span id="xor-invert"></span><span id="xor-b-mux"></span><span id="xor-a-mux"></span><span id="pt2-mux"></span><span id="pt1-mux"></span><h2>PT1/PT2 routing group<a class="headerlink" href="#pt1-pt2-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="pt3-routing-group">
<span id="gclr-mux"></span><span id="pt3-mux"></span><h2>PT3 routing group<a class="headerlink" href="#pt3-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="pt4-routing-group">
<span id="gclk-mux"></span><span id="pt4-func"></span><span id="pt4-mux"></span><h2>PT4 routing group<a class="headerlink" href="#pt4-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="pt5-routing-group">
<span id="oe-mux"></span><span id="pt5-func"></span><span id="pt5-mux"></span><h2>PT5 routing group<a class="headerlink" href="#pt5-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="d-q-routing-group">
<span id="o-mux"></span><span id="dfast-mux"></span><span id="d-mux"></span><h2>D/Q routing group<a class="headerlink" href="#d-q-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="fb-routing-group">
<span id="fb-mux"></span><h2>FB routing group<a class="headerlink" href="#fb-routing-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
<div class="section" id="ff-latch-configuration">
<span id="reset"></span><span id="storage"></span><h2>FF/latch configuration<a class="headerlink" href="#ff-latch-configuration" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<p>write this</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="buffer.html" class="btn btn-neutral float-right" title="I/O buffer options" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../naming.html" class="btn btn-neutral float-left" title="Naming conventions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, whitequark

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
    

      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>